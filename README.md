# ReCodEx file server
[![Build 
Status](https://img.shields.io/travis/ReCodEx/fileserver/master.svg?label=Build%20status)](https://travis-ci.org/ReCodEx/fileserver)

An app that serves as storage for submissions and supplementary files for 
assignments. The files are exposed via HTTP.

## Installation

1. Clone this repository
2. Install dependencies using `pip`
```
pip install -r requirements.txt
```

## Running in development mode

```
python3 fileserver.py runserver
```

Use the `--help` switch to find how to set e.g. port on which the server 
listens.

## Running using WSGI

If you need features such as HTTP authentication or efficient serving of static 
files, it is recommended to run the app in a full-fledged web server (such as 
Apache or Nginx) using WSGI. Following examples are simplified, check the help 
of the `mkconfig.py` script to see all available options.

### Running in Apache

0. Make sure you have Apache 2.4 or newer and mod_wsgi installed and enabled
1. Create a user for running the fileserver
2. Make sure that your user can access your clone of the repository
3. Run `python mkconfig/mkconfig.py apache --port PORT --user YOUR_USER --working-directory DIR`
4. Save the virtual host configuration generated by the script somewhere near the Apache configuration files
   and make sure it's included

### Running using uWSGI

1. (Optional) Create a user for running the fileserver
2. Make sure that your user can access your clone of the repository
3. Run `python mkconfig/mkconfig.py uwsgi --port PORT --user YOUR_USER 
   --working-directory DIR`
4. Save the configuration file generated by the script and run it with uWSGI, 
   either directly or using systemd. This depends heavily on your distribution
5. To integrate this with another web server, see the [uWSGI 
   doc](http://uwsgi-docs.readthedocs.io/en/latest/WebServers.html)

Note that the ways distributions package uWSGI can vay wildly. In Debian 8 it's 
necessary to convert the configuration file to XML and make sure that the 
python3 plugin is loaded instead of python. This plugin also uses Python 3.4, 
even though the rest of the system uses Python 3.5 - make sure to install 
dependencies for the correct version.
